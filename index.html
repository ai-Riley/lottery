<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ½çç³»çµ± - è³‡è¨Šç§‘æŠ€éƒ¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .header h1 {
            color: #1e3c72;
            font-size: 36px;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .main-content {
            display: block;
            margin-bottom: 20px;
        }

        .lottery-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin: 0 auto;
            max-width: 800px;
        }

        .prize-selector {
            margin-bottom: 25px;
        }

        .prize-selector label {
            display: block;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .prize-selector select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .prize-selector select:focus {
            outline: none;
            border-color: #667eea;
        }

        .prize-info {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }

        .prize-info h3 {
            color: #1e3c72;
            font-size: 20px;
            margin-bottom: 8px;
        }

        .prize-info .remaining {
            font-size: 28px;
            font-weight: bold;
            color: #e74c3c;
        }

        .draw-button {
            width: 100%;
            padding: 20px;
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(245, 87, 108, 0.4);
            transition: all 0.3s;
            margin-bottom: 25px;
        }

        .draw-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(245, 87, 108, 0.6);
        }

        .draw-button:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .draw-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .winner-display {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 3px solid #f39c12;
        }

        .winner-display.empty {
            background: #f8f9fa;
            border: 2px dashed #ddd;
        }

        .winner-display h2 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .winner-name {
            font-size: 48px;
            font-weight: bold;
            color: #e74c3c;
            margin: 15px 0;
            animation: winnerPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes winnerPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .winner-info {
            font-size: 18px;
            color: #555;
            margin: 5px 0;
        }

        .history-panel {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .history-panel h2 {
            color: #1e3c72;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            max-height: 400px;
            overflow-y: auto;
            display: block;
        }

        .history-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
        }

        .history-table th {
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }

        .history-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .history-table tbody tr:hover {
            background: #f8f9fa;
        }

        .history-table tbody {
            display: block;
            max-height: 350px;
            overflow-y: auto;
        }

        .history-table thead, .history-table tbody tr {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        .empty-message {
            text-align: center;
            color: #999;
            padding: 40px;
            font-size: 16px;
        }

        .controls {
            text-align: center;
            margin-top: 20px;
        }

        .reset-button {
            padding: 12px 30px;
            font-size: 16px;
            background: linear-gradient(135deg, #eb3949 0%, #f45c43 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(235, 57, 73, 0.4);
            transition: all 0.3s;
        }

        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(235, 57, 73, 0.6);
        }

        /* å½©ç´™æ•ˆæœ */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            opacity: 0;
            z-index: 1000;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* æ»¾å‹•æ¢ç¾åŒ– */
        .history-table tbody::-webkit-scrollbar,
        .winner-display::-webkit-scrollbar {
            width: 8px;
        }

        .history-table tbody::-webkit-scrollbar-track,
        .winner-display::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .history-table tbody::-webkit-scrollbar-thumb,
        .winner-display::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‰ è³‡è¨Šç§‘æŠ€éƒ¨æŠ½çç³»çµ± ğŸ‰</h1>
            <p>é¸æ“‡çé …ï¼Œé»æ“ŠæŠ½çæŒ‰éˆ•é–‹å§‹ï¼</p>
        </div>

        <div class="main-content">
            <div class="lottery-panel">
                <div class="prize-selector">
                    <label for="prizeSelect">é¸æ“‡çé …ï¼š</label>
                    <select id="prizeSelect">
                        <option value="">-- è«‹é¸æ“‡çé … --</option>
                    </select>
                </div>

                <div class="prize-info" id="prizeInfo" style="display: none;">
                    <h3>å‰©é¤˜æ•¸é‡</h3>
                    <div class="remaining" id="remainingCount">0</div>
                </div>

                <button class="draw-button" id="drawButton" onclick="drawWinner()" disabled>
                    ğŸ¯ é–‹å§‹æŠ½ç
                </button>

                <div class="winner-display empty" id="winnerDisplay">
                    <h2>ğŸ† ç­‰å¾…æŠ½ç ğŸ†</h2>
                    <p style="color: #999;">è«‹å…ˆé¸æ“‡çé …</p>
                </div>
            </div>
        </div>

        <div class="history-panel">
            <h2>ğŸ“‹ ä¸­çè¨˜éŒ„</h2>
            <div id="historyContainer">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th style="width: 12%; text-align: left;">çé …</th>
                            <th style="width: 40%; text-align: left;">çå“</th>
                            <th style="width: 12%; text-align: left;">å§“å</th>
                            <th style="width: 18%; text-align: left;">éƒ¨é–€</th>
                            <th style="width: 18%; text-align: left;">èª²åˆ¥</th>
                        </tr>
                    </thead>
                    <tbody id="historyBody">
                        <tr>
                            <td colspan="5" class="empty-message">å°šç„¡ä¸­çè¨˜éŒ„</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="reset-button" onclick="resetLottery()">
                    ğŸ”„ é‡ç½®æŠ½çç³»çµ±
                </button>
            </div>
        </div>
    </div>

    <script>
        // æŠ½çè³‡æ–™
        const LOTTERY_DATA = `
{
  "prizes": [
    {"category": "å¤§å…¨è¯", "name": "è²å¯¶å¾®é›»è…¦è§¸æ§é›»é™¶çˆKM-ZA13P", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "FUJIFILM LEDå¤šè§’åº¦è­·çœ¼æª¯ç‡ˆ", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "Tefal æ¥µå·§ç³»åˆ—ä¸æ²¾é‹å…·çµ„(å¹³åº•é‹+å°ç‚’é‹+é‹éŸ)", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "å¤©ä»èŒ—èŒ¶ å°ç£èŒ—è³-èŒ¶ç‹ 600g/ç½", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "THERMOS ä¸é½é‹¼å«è“‹ç«é‹28cm", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "é›™é¢æ³•è˜­çµ¨é›™äººè¢«", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "è€å”çäº®æ™¶ç²¾", "quantity": 2, "drawn": 0},
    {"category": "å£«ç´™", "name": "14å¤©æ–°ç”Ÿèˆ’æ´»éœœ", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "PHILIPSè’¸æ±½ç†¨æ–—", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "è€å”çäººè”˜ç²¾(éº¥è˜†å¡èœ‚èœœ)", "quantity": 2, "drawn": 0},
    {"category": "å£«ç´™", "name": "ä¹³æœ¨æœè¼•æŸ”æ½¤æ¾¤ä¹³æ¶²", "quantity": 2, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "ç°¡ç´„æ³•è˜­çµ¨æ¯¯(å°è±¡/å‹•ç‰©åœ’)", "quantity": 2, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "å¾—æ„çš„ä¸€å¤© æ—¥æœ¬ç„ç±³æ²¹2.4L/ç“¶", "quantity": 2, "drawn": 0},
    {"category": "å£«ç´™", "name": "èƒºåŸºé…¸ä¿æ¿•æ·¨å«©æ½”é¡ç²‰", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "é«®çš„é£Ÿè­œ-æ´—é«®éœ²(å¥‡ç•°æœç„¡èŠ±æœå»æ²¹è“¬é¬†/èœ‚èœœçŸ³æ¦´ä¿®è­·æ½¤æ¾¤)", "quantity": 2, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "Vivaè¬æ­²ç‰Œç¶œåˆçº–æœ(æä»å°é­š/ç„¡èª¿å‘³æ ¸æ¡ƒ/ç„¡èª¿å‘³æä»æœ)", "quantity": 3, "drawn": 0},
    {"category": "å£«ç´™", "name": "ç«ç‘°ç¾äººèŒ¶å¤šé…šæ°´å‡éœœ", "quantity": 3, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "ARIEL 4DæŠ—èŒæ´—è¡£è† å›Šè£œå……åŒ…-æŠ—èŒå»æ¼¬", "quantity": 4, "drawn": 0},
    {"category": "å£«ç´™", "name": "çš‡å®¶æ©™èŠ±ç²¾æ²¹èˆ’å£“ä¿æ¿•é¢è†œ(ç›’)", "quantity": 1, "drawn": 0},
    {"category": "å£«ç´™", "name": "ç²¾æ²¹ä¹‹ç‹ä¹³é¦™æœ¨æŠ—è€é¢è†œ(ç›’)", "quantity": 1, "drawn": 0},
    {"category": "å£«ç´™", "name": "ç«ç‘°ç¾äººèŒ¶å¤šé…šé¢è†œ(ç›’)", "quantity": 3, "drawn": 0},
    {"category": "å£«ç´™", "name": "èƒºåŸºé…¸ä¿®è­·æŠ—èŒæ´—æ‰‹éœ²", "quantity": 2, "drawn": 0},
    {"category": "å£«ç´™", "name": "æ«»èŠ±è¼•æ½¤èˆ’æ•è­·æ‰‹éœœ", "quantity": 1, "drawn": 0},
    {"category": "å£«ç´™", "name": "å¾©æ´»è‰æ°´æ½¤ä¿æ¿•è­·æ‰‹éœœ", "quantity": 1, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "èˆ’æ½”è˜†è–ˆæŠ½å–è¡›ç”Ÿç´™(100æŠ½x3åŒ…)", "quantity": 12, "drawn": 0},
    {"category": "å¤§å…¨è¯", "name": "èˆ’æ½”è˜†è–ˆæŠ½å–è¡›ç”Ÿç´™(100æŠ½x2åŒ…)", "quantity": 12, "drawn": 0}
  ],
  "participants": [
    {"name": "ç‹éœç‘©", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šç§‘æŠ€éƒ¨", "type": "åƒåŠ "},
    {"name": "å¡—æ–‡éš†", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "åŠ‰æœæ˜", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "æ—ä½³å®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "å‘¨å­å‡±", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "è³´éŸ‹éŒ•", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "é™³é¶æ¾§", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "æ¥Šæ¾éŒ¸", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "è”£æ–‡å‚³", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "é™³å“è±ª", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "é­å®‡è±", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "é«˜ä½‘æ¼¢", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "è³´æŸç‘", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "åƒåŠ "},
    {"name": "ç‹å‰ä»", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "æ´ªåœ‹è‚²", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "å¼µå¯¶åˆ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "é™³äº­å¦ƒ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "å¼µç“Šå‹»", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "æ–½å®£ä¸", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "éƒ­æ•æ¼¢", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "å³ä½³å—", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "åƒåŠ "},
    {"name": "é™³æ€¡å˜‰", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "è¬å¾·æ†²", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "å¼µç‘äº‘", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "ç›§éŒ¦ç…Œ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "ç‹ç•Œæ–‡", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "é™³å®£å®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "åŠ‰å®¶ä¼", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "é™³ä¼Šå©·", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "é»ƒè©©æ¶µ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "åƒåŠ "},
    {"name": "é„­åšæ–‡", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "å¼µé›…é›¯", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "å¼µéº—ç", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "æ´ªè‹±å‚‘", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "æ¸¸æ›œé§¿", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "å¼µå³ç¿°", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "åƒåŠ "},
    {"name": "è‘£æ³³æˆ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šå®‰å…¨èª²", "type": "åƒåŠ "},
    {"name": "é«˜å˜‰è‰¯", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šå®‰å…¨èª²", "type": "åƒåŠ "},
    {"name": "é„­é€¢æ¯…", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šå®‰å…¨èª²", "type": "åƒåŠ "},
    {"name": "é™³è‚²é§¿", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šå®‰å…¨èª²", "type": "åƒåŠ "},
    {"name": "æŸ¯ç¿ é’", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "},
    {"name": "é»ƒç“Šå¯¬", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "},
    {"name": "é»ƒä½³æ•", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "},
    {"name": "é™³ä¸–è±ª", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "},
    {"name": "æ¸¸æ•¦å‡±", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "},
    {"name": "é‚±ä¹‹éºŸ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "åƒåŠ "}
  ],
  "non_participants": [
    {"name": "å³å®ˆä»", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šç§‘æŠ€éƒ¨", "type": "æœªåƒåŠ "},
    {"name": "é„­å‰å®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "æœªåƒåŠ "},
    {"name": "æä¿Šé´»", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "æœªåƒåŠ "},
    {"name": "æˆ´éœ‡", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "æœªåƒåŠ "},
    {"name": "ç‹æ»™æš", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±æœå‹™èª²", "type": "æœªåƒåŠ "},
    {"name": "é„­ç¥ºç…Œ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±å“ç®¡èª²", "type": "æœªåƒåŠ "},
    {"name": "å¾å»‰å‚‘", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "æœªåƒåŠ "},
    {"name": "å¼µé‡‘è“®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "æœªåƒåŠ "},
    {"name": "é™³ä½³è‰¯", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "æœªåƒåŠ "},
    {"name": "ç‹æ¦®å®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "æœªåƒåŠ "},
    {"name": "è¬æ”¿è«º", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆä¸€èª²", "type": "æœªåƒåŠ "},
    {"name": "åŠ‰è‚²æƒ ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "æœªåƒåŠ "},
    {"name": "é™³è–çµœ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "ç³»çµ±è¨­è¨ˆäºŒèª²", "type": "æœªåƒåŠ "},
    {"name": "é¾å•Ÿäº®", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šå®‰å…¨èª²", "type": "æœªåƒåŠ "},
    {"name": "æ—å† å¸Œ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "æœªåƒåŠ "},
    {"name": "æ—å£½æ˜Œ", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "æœªåƒåŠ "},
    {"name": "æ›¹å›è±ª", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "æœªåƒåŠ "},
    {"name": "è”¡æ­£è–‡", "department": "è³‡è¨Šç§‘æŠ€éƒ¨", "division": "è³‡è¨Šæ‡‰ç”¨èª²", "type": "æœªåƒåŠ "}
  ]
}
`;

        // ç³»çµ±ç‹€æ…‹
        let lotteryData = JSON.parse(LOTTERY_DATA);
        let winnerHistory = [];
        let drawnPeople = new Set();

        // çé …åç¨±é™£åˆ—ï¼ˆä¸­æ–‡æ•¸å­—ï¼‰
        const prizeNames = [
            'é ­ç', 'è²³ç', 'åƒç', 'è‚†ç', 'ä¼ç', 'é™¸ç', 'æŸ’ç', 'æŒç', 'ç–ç', 'æ‹¾ç',
            'æ‹¾å£¹ç', 'æ‹¾è²³ç', 'æ‹¾åƒç', 'æ‹¾è‚†ç', 'æ‹¾ä¼ç', 'æ‹¾é™¸ç', 'æ‹¾æŸ’ç', 'æ‹¾æŒç', 'æ‹¾ç–ç', 'è²³æ‹¾ç',
            'è²³æ‹¾å£¹ç', 'è²³æ‹¾è²³ç', 'è²³æ‹¾åƒç', 'è²³æ‹¾è‚†ç', 'è²³æ‹¾ä¼ç', 'è²³æ‹¾é™¸ç', 'è²³æ‹¾æŸ’ç', 'è²³æ‹¾æŒç', 'è²³æ‹¾ç–ç', 'åƒæ‹¾ç'
        ];

        // ç‚ºæ¯å€‹çå“æ·»åŠ çé …åç¨±
        lotteryData.prizes.forEach((prize, index) => {
            prize.prizeName = prizeNames[index] || `ç¬¬${index + 1}ç`;
        });

        // åˆå§‹åŒ–
        function init() {
            populatePrizeSelect();
            updateStats();
            updatePrizeInfo();
        }

        // å¡«å……çé …ä¸‹æ‹‰é¸å–®
        function populatePrizeSelect() {
            const select = document.getElementById('prizeSelect');
            select.innerHTML = '<option value="">-- è«‹é¸æ“‡çé … --</option>';
            
            lotteryData.prizes.forEach((prize, index) => {
                const option = document.createElement('option');
                option.value = index;
                const remaining = prize.quantity - prize.drawn;
                option.textContent = `${prize.prizeName} - ${prize.name} (å‰©é¤˜: ${remaining}/${prize.quantity})`;
                option.disabled = remaining === 0;
                select.appendChild(option);
            });

            select.addEventListener('change', function() {
                updatePrizeInfo();
                const drawButton = document.getElementById('drawButton');
                drawButton.disabled = this.value === '';
            });
        }

        // æ›´æ–°çé …è³‡è¨Š
        function updatePrizeInfo() {
            const select = document.getElementById('prizeSelect');
            const prizeInfo = document.getElementById('prizeInfo');
            const remainingCount = document.getElementById('remainingCount');

            if (select.value !== '') {
                const prize = lotteryData.prizes[select.value];
                const remaining = prize.quantity - prize.drawn;
                remainingCount.textContent = remaining;
                prizeInfo.style.display = 'block';
            } else {
                prizeInfo.style.display = 'none';
            }
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Šï¼ˆä¿ç•™å‡½æ•¸ä»¥ç¶­æŒå…¼å®¹æ€§ï¼‰
        function updateStats() {
            // çµ±è¨ˆè³‡è¨Šå·²ç§»é™¤ï¼Œæ­¤å‡½æ•¸ä¿ç•™ä½†ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
        }

        // å‰µå»ºå½©ç´™æ•ˆæœ
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7b731', '#5f27cd', '#ffd700'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = (Math.random() * 100) + '%';
                    confetti.style.top = '-20px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animation = `confettiFall ${Math.random() * 2 + 2}s linear`;
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 20);
            }
        }

        // æŠ½çä¸»å‡½æ•¸
        function drawWinner() {
            const select = document.getElementById('prizeSelect');
            if (select.value === '') {
                alert('è«‹å…ˆé¸æ“‡çé …ï¼');
                return;
            }

            const prizeIndex = parseInt(select.value);
            const prize = lotteryData.prizes[prizeIndex];

            // æª¢æŸ¥æ˜¯å¦é‚„æœ‰å‰©é¤˜
            const remaining = prize.quantity - prize.drawn;
            if (remaining === 0) {
                alert('æ­¤çé …å·²æŠ½å®Œï¼');
                return;
            }

            // ä¸€æ¬¡æŠ½å‡ºè©²çé …çš„æ‰€æœ‰å‰©é¤˜æ•¸é‡
            const drawCount = remaining;
            const winners = [];

            for (let i = 0; i < drawCount; i++) {
                // å–å¾—å¯ç”¨çš„æŠ½çåå–®ï¼ˆéš±è—æ¢ä»¶ï¼šå…ˆæŠ½åƒåŠ çš„äººï¼‰
                let availablePool = [];
                
                // éæ¿¾å‡ºæœªä¸­ççš„åƒåŠ è€…
                const availableParticipants = lotteryData.participants.filter(
                    p => !drawnPeople.has(p.name)
                );

                // éæ¿¾å‡ºæœªä¸­ççš„æœªåƒåŠ è€…
                const availableNonParticipants = lotteryData.non_participants.filter(
                    p => !drawnPeople.has(p.name)
                );

                // å¦‚æœé‚„æœ‰åƒåŠ çš„äººï¼Œå„ªå…ˆå¾åƒåŠ çš„äººä¸­æŠ½
                if (availableParticipants.length > 0) {
                    availablePool = availableParticipants;
                } else if (availableNonParticipants.length > 0) {
                    // åƒåŠ çš„äººæŠ½å®Œäº†ï¼Œæ‰æŠ½æœªåƒåŠ çš„äºº
                    availablePool = availableNonParticipants;
                } else {
                    if (i === 0) {
                        alert('æ‰€æœ‰äººéƒ½å·²ç¶“ä¸­çäº†ï¼');
                        return;
                    } else {
                        alert(`åªèƒ½æŠ½å‡º ${i} ä½ä¸­çè€…ï¼Œå…¶é¤˜äººå“¡éƒ½å·²ä¸­çï¼`);
                        break;
                    }
                }

                // éš¨æ©ŸæŠ½å–
                const randomIndex = Math.floor(Math.random() * availablePool.length);
                const winner = availablePool[randomIndex];

                // è¨˜éŒ„ä¸­ç
                prize.drawn++;
                drawnPeople.add(winner.name);
                winners.push(winner);
                
                // è¨˜éŒ„åˆ°æ­·å²
                winnerHistory.push({
                    prize: prize,
                    winner: winner,
                    timestamp: new Date()
                });
            }

            // é¡¯ç¤ºä¸­çè€…
            displayWinners(winners, prize);

            // æ›´æ–°ä»‹é¢
            populatePrizeSelect();
            updateStats();
            updatePrizeInfo();
            updateHistory();

            // å½©ç´™æ•ˆæœ
            createConfetti();
        }

        // é¡¯ç¤ºä¸­çè€…ï¼ˆæ”¯æ´å¤šäººï¼‰
        function displayWinners(winners, prize) {
            const display = document.getElementById('winnerDisplay');
            display.classList.remove('empty');
            
            let winnersHTML = '';
            if (winners.length === 1) {
                // å–®ä¸€ä¸­çè€…
                winnersHTML = `
                    <h2>ğŸŠ æ­å–œä¸­çï¼ ğŸŠ</h2>
                    <div class="winner-name">${winners[0].name}</div>
                    <div class="winner-info">éƒ¨é–€ï¼š${winners[0].department}</div>
                    <div class="winner-info">èª²åˆ¥ï¼š${winners[0].division}</div>
                    <div style="margin-top: 20px; font-size: 18px; color: #2c3e50; font-weight: bold;">
                        ç²å¾—ï¼š${prize.name}
                    </div>
                `;
            } else {
                // å¤šä½ä¸­çè€…
                winnersHTML = `<h2>ğŸŠ æ­å–œä¸­çï¼ ğŸŠ</h2>`;
                winnersHTML += `<div style="margin: 15px 0; font-size: 18px; color: #2c3e50; font-weight: bold;">
                    çå“ï¼š${prize.name}
                </div>`;
                winnersHTML += `<div style="font-size: 16px; color: #555; margin-bottom: 15px;">å…± ${winners.length} ä½ä¸­çè€…</div>`;
                
                winners.forEach((winner, index) => {
                    winnersHTML += `
                        <div style="margin: 12px 0; padding: 12px; background: rgba(255, 255, 255, 0.8); border-radius: 8px; border-left: 4px solid #e74c3c;">
                            <div style="font-size: 24px; font-weight: bold; color: #e74c3c;">${winner.name}</div>
                            <div style="font-size: 14px; color: #555; margin-top: 5px;">
                                ${winner.department} - ${winner.division}
                            </div>
                        </div>
                    `;
                });
            }
            
            display.innerHTML = winnersHTML;
        }

        // æ›´æ–°ä¸­çè¨˜éŒ„
        function updateHistory() {
            const tbody = document.getElementById('historyBody');
            
            if (winnerHistory.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="empty-message">å°šç„¡ä¸­çè¨˜éŒ„</td></tr>';
                return;
            }

            tbody.innerHTML = '';
            winnerHistory.forEach((record, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="text-align: left; font-weight: bold; color: #667eea;">${record.prize.prizeName}</td>
                    <td style="text-align: left;">${record.prize.name}</td>
                    <td style="text-align: left; font-weight: bold; color: #e74c3c;">${record.winner.name}</td>
                    <td style="text-align: left;">${record.winner.department}</td>
                    <td style="text-align: left;">${record.winner.division}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // é‡ç½®ç³»çµ±
        function resetLottery() {
            if (!confirm('ç¢ºå®šè¦é‡ç½®æŠ½çç³»çµ±å—ï¼Ÿæ‰€æœ‰ä¸­çè¨˜éŒ„å°‡è¢«æ¸…é™¤ï¼')) {
                return;
            }

            // é‡ç½®è³‡æ–™
            lotteryData = JSON.parse(LOTTERY_DATA);
            winnerHistory = [];
            drawnPeople = new Set();

            // é‡ç½®é¡¯ç¤º
            const display = document.getElementById('winnerDisplay');
            display.classList.add('empty');
            display.innerHTML = `
                <h2>ğŸ† ç­‰å¾…æŠ½ç ğŸ†</h2>
                <p style="color: #999;">è«‹å…ˆé¸æ“‡çé …</p>
            `;

            // é‡æ–°åˆå§‹åŒ–
            init();
            updateHistory();

            alert('ç³»çµ±å·²é‡ç½®ï¼');
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.addEventListener('load', init);
    </script>
</body>
</html>
